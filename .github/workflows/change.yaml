name: MyWorkflow

on:
  repository_dispatch:
    types: [change-sha]

jobs:
  change-image-tag:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v5
        
      - name: GitOps - Update Image Tag
        run: |
            sed -i -E "s/^(\\s*imageTag:\\s*).*/\\1${{ github.event.client_payload.sha }}/" environment/dev/values.yaml
            echo "Updating image tag to ${{ github.event.client_payload.sha }}"
            echo "environment/dev/values.yaml"
            echo "imageTag"
            echo "{{ github.event.client_payload.sha }}"
          